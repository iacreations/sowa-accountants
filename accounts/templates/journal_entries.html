{% load static %}
{% load humanize %}
{% include 'includes/navbar.html' %}
{% include 'includes/sidebar.html' %}

<style>
  :root{
    --brand:#39B54B;
    --ink:#0f172a;
    --muted:#64748b;
    --line:#e5efe8;
    --thead:#f3fff6;
    --chip:#e8f5ec;
  }

  .je-container{
    margin-left:19%;
    width:80%;
    margin-top:6%;
    font-family:"Poppins",system-ui;
  }

  .je-header{
    text-align:center;
    margin-bottom:16px;
  }
  .je-header h2{
    color:var(--brand);
    margin:0;
    font-weight:800;
  }
  .je-header p{
    font-size:13px;
    color:var(--muted);
  }

  .je-card{
    background:#fff;
    border-radius:14px;
    border:1px solid var(--line);
    box-shadow:0 8px 22px rgba(0,0,0,.05);
    overflow:hidden;
  }

  table.journal{
    width:100%;
    border-collapse:separate;
    border-spacing:0;
  }

  .journal thead th{
    background:linear-gradient(0deg,var(--thead),#fff);
    color:#14532d;
    font-size:.78rem;
    text-transform:uppercase;
    padding:12px 14px;
    border-bottom:1px solid var(--line);
  }

  .journal td{
    padding:10px 14px;
    border-bottom:1px solid var(--line);
    font-size:13px;
  }

  .num{ text-align:right; }

  .rowspan{
    background:#fcfffd;
    font-weight:600;
  }

  .chip{
    background:var(--chip);
    color:#14532d;
    padding:2px 8px;
    border-radius:999px;
    font-weight:700;
    font-size:.75rem;
  }

  .je-link{
    text-decoration:none;
    color:inherit;
  }
  .je-link:hover{
    text-decoration:underline;
  }

  tfoot td{
    background:#f7fff9;
    font-weight:800;
  }
</style>

<div class="je-container">
  <div class="je-header">
    <h2>Journal Entries</h2>
    <p>Detailed list of all double-entry postings</p>
  </div>

  <div class="je-card">
    <table class="journal">
      <thead>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>ID no.</th>
          <th>Account</th>
          <th class="num">Debit</th>
          <th class="num">Credit</th>
        </tr>
      </thead>

      <tbody>
        {% for entry in entries %}
          {% for line in entry.lines.all %}
            <tr>
              {% if forloop.first %}
                <td class="rowspan" rowspan="{{ entry.lines.count }}">
                  <a href="{{ entry.edit_url }}" class="je-link">
                    {{ entry.date|date:"M. j, Y" }}
                  </a>
                </td>

                <td class="rowspan" rowspan="{{ entry.lines.count }}">
                  <a href="{{ entry.edit_url }}" class="je-link">
                    {{ entry.description|default:"â€”" }}
                  </a>
                </td>

                <td class="rowspan" rowspan="{{ entry.lines.count }}">
                  <a href="{{ entry.edit_url }}" class="je-link">
                    <span class="chip">#{{ entry.id|stringformat:"04d" }}</span>
                  </a>
                </td>
              {% endif %}

              <td>{{ line.account.account_name }}</td>
              <td class="num">{{ line.debit|floatformat:2|intcomma }}</td>
              <td class="num">{{ line.credit|floatformat:2|intcomma }}</td>
            </tr>
          {% endfor %}
        {% endfor %}
      </tbody>

      <tfoot>
        <tr>
          <td colspan="3"></td>
          <td>Total</td>
          <td class="num">{{ grand_debit|floatformat:2|intcomma }}</td>
          <td class="num">{{ grand_credit|floatformat:2|intcomma }}</td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>

{% include 'includes/footer.html' %}
