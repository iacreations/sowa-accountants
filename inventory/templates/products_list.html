{% load static humanize %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Inventory Products</title>
  <link rel="icon" type="image/x-icon" href="{% static 'sowaf/images/favicon.ico' %}">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet"/>

  <style>
    :root{
      --brand:#39B54B; --ink:#0b3d22;
      --bg:#f4f6f8; --panel:#fff; --line:#e8e8e8;
      --muted:#667085; --ok:#16a34a; --warn:#f59e0b; --bad:#ef4444;
    }
    *{box-sizing:border-box}
    body{background:var(--bg);font-family:"Poppins",system-ui,Arial,sans-serif;margin:0;padding:24px}
    
    .wrap{width:83%;margin-top: 5%;margin-left: 18.3%;background:var(--panel);border:1px solid var(--line);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.06);overflow:hidden}

    .head{
      display:flex;align-items:center;justify-content:space-between;
      gap:16px;padding:18px 20px;border-bottom:1px solid var(--line)
    }

    .title{
      font-weight:800;color:var(--brand);font-size:22px
    }

    .chip{
      display:inline-block;background:#f1f5f9;border:1px solid #e2e8f0;
      padding:4px 10px;border-radius:999px;font-size:12px;font-weight:800
    }

    .body{padding:18px}

    .sec{
      border:1px solid var(--line);
      border-radius:12px;padding:14px;background:#fff
    }

    .sec h4{
      margin:0 0 10px 0;font-size:14px;
      color:#111827;font-weight:800
    }

    table{
      width:100%;border-collapse:separate;border-spacing:0;
      border:1px solid var(--line);border-radius:10px;overflow:hidden
    }

    thead th{
      background:#f8fafc;color:#0f172a;
      padding:10px;text-align:left;font-weight:800;font-size:13px
    }

    tbody td{
      padding:10px;border-top:1px solid var(--line);font-size:13px
    }

    a.link{
      color:#0b3d22;font-weight:800;text-decoration:none
    }

    a.link:hover{ text-decoration:underline }

    .btn{
      background:var(--brand);color:#fff;border:0;border-radius:10px;
      padding:8px 12px;font-weight:800;text-decoration:none;
      display:inline-flex;align-items:center;gap:6px
    }

    .btn.alt{
      background:#d8f5e0;color:#14532d
    }

    .badge{
      padding:4px 10px;border-radius:999px;font-size:12px;font-weight:900
    }

    .badge.ok{
      background:#eafff0;color:#166534;border:1px solid #bbf7d0
    }

    .badge.low{
      background:#fff7e5;color:#92400e;border:1px solid #fde68a
    }

    .badge.out{
      background:#ffe8e8;color:#991b1b;border:1px solid #fecaca
    }

    .footer-actions{
      margin-top:12px
    }
  </style>
</head>
<body>

{% include 'includes/navbar.html' %}
{% include 'includes/sidebar.html' %}

<div class="wrap" style="margin-top:5%; float:right;">

  <div class="head">
    <div class="title">Inventory Products</div>
    <div class="chip">
      {{ products|length }} Items
    </div>
  </div>

  <div class="body">

    <div class="sec">
      <h4>Products</h4>

      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>SKU</th>
            <th>Category</th>
            <th>Qty On Hand</th>
            <th>Avg Cost</th>
            <th>Stock Value</th>
            <th style="width:120px;">Action</th>
          </tr>
        </thead>

        <tbody>
          {% for p in products %}

          {% with stock_value=p.quantity|floatformat:2 %}
          <tr>

            <td>
              <a class="link" href="{% url 'inventory:product-detail' p.id %}">
                {{ p.name }}
              </a>
            </td>

            <td>{{ p.sku|default:"—" }}</td>

            <td>{{ p.category|default:"—" }}</td>

            <td>
              {% if p.quantity <= 0 %}
                <span class="badge out">Out</span>
              {% elif p.quantity <= 5 %}
                <span class="badge low">{{ p.quantity|floatformat:2 }}</span>
              {% else %}
                <span class="badge ok">{{ p.quantity|floatformat:2 }}</span>
              {% endif %}
            </td>

            <td>{{ p.avg_cost|floatformat:2|intcomma }}</td>

            <td>
              {{ p.quantity|floatformat:2|floatformat:2 }}
            </td>

            <td>
              <a class="btn"
                 href="{% url 'inventory:product-detail' p.id %}">
                <i class='bx bx-show'></i> View
              </a>
            </td>

          </tr>
          {% endwith %}

          {% empty %}
          <tr>
            <td colspan="7">No inventory products found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="footer-actions">
        <a class="btn alt" href="{% url 'inventory:movements-list' %}">
          <i class='bx bx-transfer'></i> View Movements Ledger
        </a>
      </div>

    </div>
  </div>
</div>
{% include 'includes/footer.html' %}
</body>
</html>
