{% load humanize %}

<div>
  <h1>Statement</h1>

  <div class="muted">
    {{ customer.customer_name|default:customer.company_name }} •
    Type: {{ st.get_statement_type_display }} •
    Period: {{ st.start_date }} — {{ st.end_date }} •
    Statement date: {{ st.statement_date }}
  </div>

  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>No.</th>
      
        <th class="num">Running balance</th>
      </tr>
    </thead>

    <tbody>
 
      {# ✅ Statement lines (Type = selected statement type, No = ST-000X, Running = LIVE A/R) #}
      {% for ln in lines %}
        <tr>
          <td>{{ ln.date|date:"Y-m-d" }}</td>

          <td>
            <span class="badge">
              {{ st.get_statement_type_display }}
            </span>
          </td>

          <td>ST-000{{ st.id }}</td>

          <td class="num">
            {{ live_closing|default:0|floatformat:2|intcomma }}
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="5" class="muted" style="padding:10px;">
            No statement lines found for this statement.
          </td>
        </tr>
      {% endfor %}
    </tbody>

    <tfoot>
      <tr>
        <td colspan="4">Closing balance </td>
        <td class="num">{{ live_closing|default:0|floatformat:2|intcomma }}</td>
      </tr>
    </tfoot>
  </table>

  <p class="muted" style="margin-top:10px;">
    * Positive = customer owes you. Negative = you owe customer (credit).
  </p>
</div>
